<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>

        @font-face{
            font-family:'DNFBitBitv2';
            src: url('../font/DNFBitBitTTF.ttf') format('truetype');
        }

        body {
            font-family: 'DNFBitBitv2';
            margin: 0;
            padding: 0;
            display: flex;
            align-items: flex-start;
            height: 100vh;
            background-image: url("../img/background1.png");
            background-repeat: no-repeat;
            
            background-size: 100% 100%;
        }
        .itd {
            text-align: center;
            font-size: 20px;
        }
        
    </style>
</head>
<body>
    
    <div th:if="${session.user} == null">
        <a href="/tmpl/user-info/login">로그인</a>
        <a href="/tmpl/user-info/join">회원가입</a>
    </div>
    <div class="itd" th:if="${session.user} != null">
        <span style="color: red;" th:text="${session.user.uiName}"></span>님 안녕하세요.<br>
    </div>
    <div id="game-list"></div>
    최고점수 : <span id="maxScore"></span>
    <table border="1">
        <tr>
            <th>랭킹</th>
            <th>이름</th>
            <th>점수</th>
        </tr>
        <tbody id="Rank">
        </tbody>
    </table>
    <script>
        window.addEventListener('load',async function(){
            const res = await fetch('/game-infos');
            const games = await res.json();
            let html = '';
            for(const game of games) {
                html += `<a href='/tmpl/game'>${game.giName}</a>`;
            }
            document.querySelector('#game-list').innerHTML = html;
        });

        window.addEventListener('load',async function(){
            const res = await fetch('/point-infos/max?giNum=1');
            const point = await res.json();
            document.querySelector('#maxScore').innerHTML = `<b>${point.piPoint}</b>`;
        })

        window.addEventListener('load',async function(){
            const res = await fetch('/point-infos/rank?giNum=1');
            const ranks = await res.json();
            let html = '';
            let i = 1;
            for(const rank of ranks) {
                html += '<tr>';
                html += `<td>${i++}</td>`;
                html += `<td>${rank.uiName}</td>`;
                html += `<td>${rank.piPoint}</td>`;
                html += '</tr>'
            }
            document.querySelector('#Rank').innerHTML = html;
        })
    </script>
</body>
</html>